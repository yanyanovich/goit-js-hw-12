{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44768400-50ed818a42c4b3c7dfabdf0f1';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: perPage,\n    },\n  });\n  if (response.status !== 200) {\n    throw new Error(response.status);\n  }\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nexport function createMarkup(images, isNewSearch = true) {\n  const galleryElement = document.querySelector('.gallery');\n  if (isNewSearch) galleryElement.innerHTML = '';\n\n  if (images.length === 0) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n    return;\n  }\n  const markup = images\n    .map(\n      image => `\n      <li class=\"gallery-item\">\n        <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n          <div class=\"info\">\n            <p class=\"info-item\"><b>Likes</b> ${image.likes}</p>\n            <p class=\"info-item\"><b>Views</b> ${image.views}</p>\n            <p class=\"info-item\"><b>Comments</b> ${image.comments}</p>\n            <p class=\"info-item\"><b>Downloads</b> ${image.downloads}</p>\n          </div>\n        </a>\n    </li>\n  `\n    )\n    .join('');\n\n  galleryElement.insertAdjacentHTML('beforeend', markup);\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n  });\n  lightbox.refresh();\n\n  if (!isNewSearch) {\n    smoothScroll();\n  }\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nexport function showLoader() {\n  const loader = document.querySelector('.loader');\n  loader.classList.add('visible');\n}\n\nexport function hideLoader() {\n  const loader = document.querySelector('.loader');\n  loader.classList.remove('visible');\n}\n\nexport function clearSearchInput() {\n  const input = document.querySelector('#search-input');\n  input.value = '';\n}\n\nexport function toggleLoadMoreBtn(shouldShow) {\n  const loadMoreBtn = document.querySelector('#load-more-btn');\n  if (shouldShow) {\n    loadMoreBtn.classList.remove('hidden');\n  } else {\n    loadMoreBtn.classList.add('hidden');\n  }\n}\n","import iziToast from 'izitoast';\n\nimport { fetchImages } from './js/pixabay-api.js';\nimport {\n  createMarkup,\n  showLoader,\n  hideLoader,\n  clearSearchInput,\n  toggleLoadMoreBtn,\n} from './js/render-functions.js';\n\nlet currentPage = 1;\nlet currentQuery = '';\nconst perPage = 15;\n\nconst formEl = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.search-input'),\n  loadMoreButton: document.querySelector('#load-more-btn'),\n};\nformEl.form.addEventListener('submit', onsubmit);\nformEl.loadMoreButton.addEventListener('click', loadMoreImages);\n\nasync function onsubmit(event) {\n  event.preventDefault();\n  const query = formEl.input.value.trim();\n\n  if (query === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search term!',\n    });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n\n  showLoader();\n  toggleLoadMoreBtn(false);\n\n  try {\n    const { hits, totalHits } = await fetchImages(\n      currentQuery,\n      currentPage,\n      perPage\n    );\n\n    if (hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      toggleLoadMoreBtn(false);\n      return;\n    }\n\n    createMarkup(hits, true);\n    clearSearchInput();\n\n    if (hits.length < perPage || currentPage * perPage >= totalHits) {\n      toggleLoadMoreBtn(false);\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      toggleLoadMoreBtn(true);\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again!',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function loadMoreImages() {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const { hits, totalHits } = await fetchImages(\n      currentQuery,\n      currentPage,\n      perPage\n    );\n    createMarkup(hits, false);\n    const loadedImages = currentPage * perPage;\n    toggleLoadMoreBtn(loadedImages < totalHits);\n    if (loadedImages >= totalHits) {\n      toggleLoadMoreBtn(false);\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again!',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","perPage","response","axios","createMarkup","images","isNewSearch","galleryElement","iziToast","markup","image","SimpleLightbox","smoothScroll","cardHeight","showLoader","hideLoader","clearSearchInput","input","toggleLoadMoreBtn","shouldShow","loadMoreBtn","currentPage","currentQuery","formEl","onsubmit","loadMoreImages","event","hits","totalHits","loadedImages"],"mappings":"owBAEA,MAAMA,EAAU,qCACVC,EAAW,2BAEV,eAAeC,EAAYC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CAC/D,MAAMC,EAAW,MAAMC,EAAM,IAAIN,EAAU,CACzC,OAAQ,CACN,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAUC,CACX,CACL,CAAG,EACD,GAAIC,EAAS,SAAW,IACtB,MAAM,IAAI,MAAMA,EAAS,MAAM,EAEjC,OAAOA,EAAS,IAClB,CCnBO,SAASE,EAAaC,EAAQC,EAAc,GAAM,CACvD,MAAMC,EAAiB,SAAS,cAAc,UAAU,EAGxD,GAFID,IAAaC,EAAe,UAAY,IAExCF,EAAO,SAAW,EAAG,CACvBG,EAAS,MAAM,CACb,MAAO,QACP,QACE,0EACR,CAAK,EACD,MACD,CACD,MAAMC,EAASJ,EACZ,IACCK,GAAS;AAAA;AAAA,mBAEIA,EAAM,aAAa;AAAA,sBAChBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,gDAEZA,EAAM,KAAK;AAAA,gDACXA,EAAM,KAAK;AAAA,mDACRA,EAAM,QAAQ;AAAA,oDACbA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,GAK9D,EACA,KAAK,EAAE,EAEVH,EAAe,mBAAmB,YAAaE,CAAM,EACpC,IAAIE,EAAe,aAAc,CAChD,aAAc,KAClB,CAAG,EACQ,QAAO,EAEXL,GACHM,GAEJ,CAEA,SAASA,GAAe,CACtB,KAAM,CAAE,OAAQC,CAAU,EAAK,SAC5B,cAAc,eAAe,EAC7B,wBACH,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CAEO,SAASC,GAAa,CACZ,SAAS,cAAc,SAAS,EACxC,UAAU,IAAI,SAAS,CAChC,CAEO,SAASC,GAAa,CACZ,SAAS,cAAc,SAAS,EACxC,UAAU,OAAO,SAAS,CACnC,CAEO,SAASC,GAAmB,CACjC,MAAMC,EAAQ,SAAS,cAAc,eAAe,EACpDA,EAAM,MAAQ,EAChB,CAEO,SAASC,EAAkBC,EAAY,CAC5C,MAAMC,EAAc,SAAS,cAAc,gBAAgB,EACvDD,EACFC,EAAY,UAAU,OAAO,QAAQ,EAErCA,EAAY,UAAU,IAAI,QAAQ,CAEtC,CChEA,IAAIC,EAAc,EACdC,EAAe,GACnB,MAAMrB,EAAU,GAEVsB,EAAS,CACb,KAAM,SAAS,cAAc,OAAO,EACpC,MAAO,SAAS,cAAc,eAAe,EAC7C,eAAgB,SAAS,cAAc,gBAAgB,CACzD,EACAA,EAAO,KAAK,iBAAiB,SAAUC,CAAQ,EAC/CD,EAAO,eAAe,iBAAiB,QAASE,CAAc,EAE9D,eAAeD,EAASE,EAAO,CAC7BA,EAAM,eAAc,EACpB,MAAM3B,EAAQwB,EAAO,MAAM,MAAM,KAAI,EAErC,GAAIxB,IAAU,GAAI,CAChBS,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,6BACf,CAAK,EACD,MACD,CAEDc,EAAevB,EACfsB,EAAc,EAEdP,IACAI,EAAkB,EAAK,EAEvB,GAAI,CACF,KAAM,CAAE,KAAAS,EAAM,UAAAC,CAAW,EAAG,MAAM9B,EAChCwB,EACAD,EACApB,CACN,EAEI,GAAI0B,EAAK,SAAW,EAAG,CACrBnB,EAAS,MAAM,CACb,MAAO,QACP,QACE,0EACV,CAAO,EACDU,EAAkB,EAAK,EACvB,MACD,CAEDd,EAAauB,EAAM,EAAI,EACvBX,IAEIW,EAAK,OAAS1B,GAAWoB,EAAcpB,GAAW2B,GACpDV,EAAkB,EAAK,EACvBV,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACjB,CAAO,GAEDU,EAAkB,EAAI,CAEzB,MAAe,CACdV,EAAS,MAAM,CACb,MAAO,QACP,QAAS,yCACf,CAAK,CACL,QAAY,CACRO,GACD,CACH,CAEA,eAAeU,GAAiB,CAC9BJ,GAAe,EACfP,IAEA,GAAI,CACF,KAAM,CAAE,KAAAa,EAAM,UAAAC,CAAW,EAAG,MAAM9B,EAChCwB,EACAD,EACApB,CACN,EACIG,EAAauB,EAAM,EAAK,EACxB,MAAME,EAAeR,EAAcpB,EACnCiB,EAAkBW,EAAeD,CAAS,EACtCC,GAAgBD,IAClBV,EAAkB,EAAK,EACvBV,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACjB,CAAO,EAEJ,MAAe,CACdA,EAAS,MAAM,CACb,MAAO,QACP,QAAS,yCACf,CAAK,CACL,QAAY,CACRO,GACD,CACH"}